version: "3.9"
services:
  crawl4ai:
    image: uncle_code/crawl_for_ai:basic-amd64
    restart: unless-stopped
    ports:
      - "8080:8080"            # внешний 8080 -> внутренний 8080
    environment:
      CRAWL_FOR_AI_API_TOKEN: ${CRAWL_FOR_AI_API_TOKEN}
      PORT: 8080
    shm_size: "1g"             # важно для headless-браузера
    healthcheck:
      test: ["CMD-SHELL", "wget -qO- http://localhost:8080/docs >/dev/null || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
